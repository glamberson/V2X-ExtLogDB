Public Function GetFulfillmentHistory(fulfillmentItemID As Long) As ADODB.Recordset
    Dim cmd As ADODB.Command
    Dim rs As ADODB.Recordset
    
    Set cmd = New ADODB.Command
    With cmd
        .ActiveConnection = g_conn
        .CommandType = adCmdText
        .CommandText = "SELECT * FROM get_fulfillment_history(:fulfillment_item_id)"
        .Parameters.Append .CreateParameter("fulfillment_item_id", adInteger, adParamInput, , fulfillmentItemID)
    End With
    
    Set rs = cmd.Execute
    Set GetFulfillmentHistory = rs
End Function



Private Sub Form_Load()
    Dim rs As ADODB.Recordset
    Dim fulfillmentItemID As Long
    
    fulfillmentItemID = Me.OpenArgs ' Assume the fulfillment_item_id is passed when opening the form
    Set rs = GetFulfillmentHistory(fulfillmentItemID)
    Set Me.subFormHistory.Form.Recordset = rs
End Sub