

' version 0.7.2



' Function to log an action
Public Sub LogAction(action As String, details As String)
    Dim conn As ADODB.Connection
    Dim cmd As ADODB.Command

    Set conn = CreatePostgresConnection()

    Set cmd = New ADODB.Command
    cmd.ActiveConnection = conn
    cmd.CommandText = "SELECT log_action(?, ?, ?)"
    cmd.Parameters.Append cmd.CreateParameter("@p_session_id", adVarChar, adParamInput, 255, g_sessionToken)
    cmd.Parameters.Append cmd.CreateParameter("@p_action", adVarChar, adParamInput, 255, action)
    cmd.Parameters.Append cmd.CreateParameter("@p_details", adVarChar, adParamInput, 255, details)
    
    cmd.Execute

    conn.Close
End Sub
