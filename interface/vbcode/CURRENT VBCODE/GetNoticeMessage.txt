' version 0.8.40
' Helper function to get NOTICE messages

Private Function GetNoticeMessage(conn As ADODB.Connection) As String
    Dim cmd As ADODB.Command
    Dim rs As ADODB.Recordset
    
    Set cmd = New ADODB.Command
    With cmd
        .ActiveConnection = conn
        .CommandText = "SELECT pg_get_last_result_notices() AS notice"
    End With
    
    Set rs = cmd.Execute
    
    If Not rs.EOF Then
        GetNoticeMessage = rs.Fields("notice").Value
    Else
        GetNoticeMessage = ""
    End If
    
    rs.Close
    Set rs = Nothing
    Set cmd = Nothing
End Function

