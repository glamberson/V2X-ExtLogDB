' version 0.9.31
' Helper function to log errors, duplicates, and warnings

Public Sub LogErrorsAndDuplicates(totalCount As Long, successCount As Long, duplicateOrWarningCount As Long, errorCount As Long, errorLog As String, Optional isWarning As Boolean = False)
    Dim db As DAO.Database
    Dim rst As DAO.Recordset
    Dim countType As String
    
    countType = IIf(isWarning, "Warning", "Duplicate")
    
    Set db = CurrentDb()
    Set rst = db.OpenRecordset("ErrorLog", dbOpenDynaset)
    
    rst.AddNew
    rst!LogDate = Now()
    rst!totalCount = totalCount
    rst!successCount = successCount
    rst!duplicateCount = duplicateOrWarningCount
    rst!errorCount = errorCount
    rst!ErrorDetails = errorLog
    rst!LogType = IIf(isWarning, "Warning", "Duplicate")
    rst.Update
    
    rst.Close
    Set rst = Nothing
    Set db = Nothing
End Sub

