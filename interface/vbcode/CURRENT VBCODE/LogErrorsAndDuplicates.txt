' version 0.8.40
' Helper function to log errors and duplicates

Private Sub LogErrorsAndDuplicates(totalCount As Long, successCount As Long, duplicateCount As Long, errorCount As Long, errorLog As String)
    Dim db As DAO.Database
    Dim rst As DAO.Recordset
    
    Set db = CurrentDb()
    Set rst = db.OpenRecordset("ErrorLog", dbOpenDynaset)
    
    rst.AddNew
    rst!LogDate = Now()
    rst!TotalCount = totalCount
    rst!SuccessCount = successCount
    rst!DuplicateCount = duplicateCount
    rst!ErrorCount = errorCount
    rst!ErrorDetails = errorLog
    rst.Update
    
    rst.Close
    Set rst = Nothing
    Set db = Nothing
End Sub

