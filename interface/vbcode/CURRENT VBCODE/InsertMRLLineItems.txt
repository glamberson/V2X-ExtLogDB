

' insert mrl line items
' version 0.8.12

Public Sub InsertMRLLineItems()
    Dim jsonData As String
    Dim updateSource As String
    Dim result As Boolean
    
    Set frm = Forms!frMRL
    jsonData = ConvertToJSON()
    updateSource = frm.txtUpdateSource.Value ' Get the update source from the text box
    
    ' Debugging output
    Debug.Print "JSON Data: " & jsonData
    Debug.Print "Update Source: " & updateSource
    
    ' Call the protected function
    result = ExecuteProtectedFunction("insert_mrl_line_items", jsonData, updateSource)
    
    ' Check the result
    If result Then
        MsgBox "Data inserted successfully", vbInformation
    Else
        MsgBox "Failed to insert data. Check the Immediate window for details.", vbExclamation
        
        ' Additional error reporting
        Debug.Print "--- Error Details ---"
        Debug.Print "JSON Data Length: " & Len(jsonData)
        Debug.Print "First 1000 characters of JSON Data:"
        Debug.Print Left(jsonData, 1000)
        Debug.Print "Last 1000 characters of JSON Data:"
        Debug.Print Right(jsonData, 1000)
        Debug.Print "Update Source: " & updateSource
        Debug.Print "--------------------"
    End If
End Sub
