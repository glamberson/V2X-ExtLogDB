' version 0.8.56
' Helper function to find the column number based on the header name
Private Function FindColumnByName(sheet As Object, columnName As String, headerRow As Long) As Long
    Dim col As Long
    Dim lastCol As Long
    
    lastCol = sheet.Cells(headerRow, sheet.Columns.Count).End(xlToLeft).Column
    
    For col = 1 To lastCol
        If LCase(Trim(sheet.Cells(headerRow, col).Value)) = LCase(Trim(columnName)) Then
            FindColumnByName = col
            Exit Function
        End If
    Next col
    
    FindColumnByName = 0 ' Return 0 if not found
End Function

