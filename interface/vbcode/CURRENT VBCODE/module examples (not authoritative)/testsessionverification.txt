Public Function TestSessionVerification() As Boolean
    Dim cmd As ADODB.Command
    Dim rs As ADODB.Recordset
    Dim isValid As Boolean
    
    Set cmd = New ADODB.Command
    cmd.ActiveConnection = g_conn
    cmd.CommandText = "SELECT * FROM verify_session(?)"
    cmd.Parameters.Append cmd.CreateParameter("@p_session_id", adGUID, adParamInput, , g_sessionToken)
    
    Set rs = cmd.Execute
    
    If Not rs.EOF Then
        isValid = rs.Fields("is_valid").Value
        Debug.Print "Session Valid: " & isValid
        Debug.Print "User ID: " & rs.Fields("user_id").Value
        Debug.Print "Role ID: " & rs.Fields("role_id").Value
    Else
        Debug.Print "Session not found"
        isValid = False
    End If
    
    rs.Close
    TestSessionVerification = isValid
End Function