Public Function SelectWorksheet(xlWorkbook As Object) As Object
    Dim sheetName As String
    Dim xlSheet As Object
    
    ' Prompt the user to select a sheet
    sheetName = InputBox("Enter the name of the sheet to use:", "Select Sheet", xlWorkbook.Sheets(1).Name)
    
    ' Validate the selected sheet name
    On Error Resume Next
    Set xlSheet = xlWorkbook.Sheets(sheetName)
    On Error GoTo 0
    
    If xlSheet Is Nothing Then
        MsgBox "The sheet named '" & sheetName & "' does not exist. Please check the sheet name and try again.", vbExclamation
    End If
    
    Set SelectWorksheet = xlSheet
End Function
