Public Function ValidateExcelData(xlSheet As Object, validationRules As Collection, columnLookup As Object) As Boolean
    Dim row As Integer
    Dim isValid As Boolean
    Dim rule As Variant
    isValid = True

    ' Iterate through each row and apply validation rules
    For row = 2 To xlSheet.Cells(xlSheet.Rows.Count, 1).End(-4162).Row
        For Each rule In validationRules
            If Not rule(xlSheet, row, columnLookup) Then
                isValid = False
                Exit For
            End If
        Next rule
        
        If Not isValid Then Exit For
    Next row

    ValidateExcelData = isValid
End Function
