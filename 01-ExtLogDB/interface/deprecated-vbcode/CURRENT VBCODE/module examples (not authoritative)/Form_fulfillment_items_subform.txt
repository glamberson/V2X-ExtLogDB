Option Compare Database
Private Sub LoadSubForm()
    On Error GoTo ErrorHandler

    Dim subformRs As ADODB.Recordset
    Dim subformSqlQuery As String
    
    ' Get the current order_line_item_id from the main form
    Dim currentOrderLineItemId As Long
    currentOrderLineItemId = Me!order_line_item_id
    
    ' Define the SQL query for the subform
    subformSqlQuery = "SELECT * FROM fulfillment_items WHERE order_line_item_id = " & currentOrderLineItemId
    
    ' Open the subform's recordset using the global connection
    Set subformRs = New ADODB.Recordset
    subformRs.CursorLocation = adUseClient ' Use client-side cursor
    subformRs.Open subformSqlQuery, g_conn, adOpenStatic, adLockReadOnly
    
    ' Bind the subform's recordset to the data
    Set Me.fulfillment_items_subform.Form.Recordset = subformRs

    Exit Sub

ErrorHandler:
    MsgBox "Error " & Err.Number & ": " & Err.description, vbCritical, "Connection Error"
End Sub

Private Sub Form_Current()
    Call LoadSubForm
End Sub

