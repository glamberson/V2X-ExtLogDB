Private Sub Form_Load()
    On Error GoTo ErrorHandler

    Dim rs As ADODB.Recordset
    Dim sqlQuery As String
    
    ' Define the SQL query to select from the view
    sqlQuery = "SELECT * FROM availability_events"
    
    ' Open the recordset using the global connection
    Set rs = New ADODB.Recordset
    rs.CursorLocation = adUseClient ' Use client-side cursor
    rs.Open sqlQuery, g_conn, adOpenStatic, adLockReadOnly
    
    ' Ensure the form's existing RecordSource property is cleared
    Me.RecordSource = ""

    ' Bind the form's recordset to the view's data
    Set Me.Recordset = rs

    ' Explicitly refresh the form to ensure the data appears
    Me.Requery

  
    Exit Sub

ErrorHandler:
    MsgBox "Error " & Err.Number & ": " & Err.description, vbCritical, "Connection Error"
End Sub

