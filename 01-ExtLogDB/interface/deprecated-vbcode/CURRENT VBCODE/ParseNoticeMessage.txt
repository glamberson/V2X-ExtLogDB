
' Helper function to parse NOTICE message
' version 0.8.80

Public Function ParseNoticeMessage(message As String) As Variant
    Dim result(3) As Long
    Dim matches As Object
    Dim regex As Object
    
    Set regex = CreateObject("VBScript.RegExp")
    regex.Pattern = "Total: (\d+), Success: (\d+), Duplicates: (\d+), Errors: (\d+)"
    regex.Global = False
    
    Set matches = regex.Execute(message)
    
    If matches.count > 0 Then
        result(0) = CLng(matches(0).SubMatches(0)) ' Total
        result(1) = CLng(matches(0).SubMatches(1)) ' Success
        result(2) = CLng(matches(0).SubMatches(2)) ' Duplicates
        result(3) = CLng(matches(0).SubMatches(3)) ' Errors
    Else
        ' If no match is found, set all values to -1 to indicate an error
        result(0) = -1
        result(1) = -1
        result(2) = -1
        result(3) = -1
    End If
    
    ParseNoticeMessage = result
End Function

