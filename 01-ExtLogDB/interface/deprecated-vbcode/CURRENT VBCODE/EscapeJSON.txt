' Helper function to escape JSON
' version 0.8.60 REVERTED 39

Private Function EscapeJSON(ByVal text As String) As String
    Dim i As Integer
    Dim char As String
    Dim result As String
    
    For i = 1 To Len(text)
        char = Mid(text, i, 1)
        Select Case AscW(char)
            Case 8:  result = result & "\b"
            Case 9:  result = result & "\t"
            Case 10: result = result & "\n"
            Case 12: result = result & "\f"
            Case 13: result = result & "\r"
            Case 34: result = result & "\"""
            Case 92: result = result & "\\"
            Case 0 To 31
                result = result & "\u" & Right("0000" & Hex(AscW(char)), 4)
            Case Else
                result = result & char
        End Select
    Next i
    
    EscapeJSON = result
End Function

