CREATE OR REPLACE FUNCTION insert_raw_egypt_weekly_report(
    p_report_name VARCHAR(255),
    p_report_date DATE,
    p_sheet_name VARCHAR(255),
    p_column_names TEXT[],
    p_row_data JSONB
)
RETURNS BOOLEAN AS $$
BEGIN
    INSERT INTO raw_egypt_weekly_reports (
        report_name,
        report_date,
        sheet_name,
        column_names,
        row_data
    ) VALUES (
        p_report_name,
        p_report_date,
        p_sheet_name,
        p_column_names,
        p_row_data
    );
    
    RETURN TRUE;
EXCEPTION
    WHEN OTHERS THEN
        RAISE NOTICE 'Error inserting raw Egypt Weekly Report data: %', SQLERRM;
        RETURN FALSE;
END;
$$ LANGUAGE plpgsql;

